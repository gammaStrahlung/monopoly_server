# Monopoly Server

[![Quality Gate Status](https://sonarcloud.io/api/project_badges/measure?project=gammaStrahlung_monopoly_server&metric=alert_status)](https://sonarcloud.io/summary/new_code?id=gammaStrahlung_monopoly_server)
[![Bugs](https://sonarcloud.io/api/project_badges/measure?project=gammaStrahlung_monopoly_server&metric=bugs)](https://sonarcloud.io/summary/new_code?id=gammaStrahlung_monopoly_server)
[![Code Smells](https://sonarcloud.io/api/project_badges/measure?project=gammaStrahlung_monopoly_server&metric=code_smells)](https://sonarcloud.io/summary/new_code?id=gammaStrahlung_monopoly_server)
[![Coverage](https://sonarcloud.io/api/project_badges/measure?project=gammaStrahlung_monopoly_server&metric=coverage)](https://sonarcloud.io/summary/new_code?id=gammaStrahlung_monopoly_server)
[![Duplicated Lines (%)](https://sonarcloud.io/api/project_badges/measure?project=gammaStrahlung_monopoly_server&metric=duplicated_lines_density)](https://sonarcloud.io/summary/new_code?id=gammaStrahlung_monopoly_server)

## About the project

This projects implements the monopoly game logic used by the [Monopoly App](https://github.com/gammaStrahlung/monopoly_app).
These functions can be accessed through the WebSocket connection `ws://HOST:53211/monopoly`.

## Getting started

### Running native

A Java JDK 17 installation is needed to run this application.
Newer versions should also work but this has not been tested and is not guaranteed to work.
This project uses the [Gradle](https://gradle.org/) Build Tool which provides the `gradlew` wrapper, which automatically downloads the required Gradle version.

* Clone the [repository](https://github.com/gammaStrahlung/monopoly_server)
    ```sh
    git clone https://github.com/gammaStrahlung/monopoly_server.git
    ```
* To run the project run the following command in the cloned folder:
    ```sh
    ./gradlew bootRun
    ```
* To build a `.jar` file for deployment execute the following command:
    ```sh
    ./gradlew bootJar
    ```
    * The `.jar` is located at `build/libs/monopoly_server-vX.X.X.jar`

### Running on Docker

You can also run this project using Docker.
Pre-built images are available in the [**Github Container registry**](https://github.com/gammaStrahlung/monopoly_server/pkgs/container/monopoly_server).

Use the following command to run the latest version:
```sh
docker run -d -p 53211:53211 ghcr.io/gammastrahlung/monopoly_server:latest
```

#### Building the docker image

* First you need to build a `.jar` file. Refer to the above instructions on how to do this.

* You can then build the Docker image using the following command:
    ```sh
    docker build -t monopoly_server .
    ```
    This builds an image with the name `monopoly_server`

## Development

This project uses [Spring Boot WebSockets](https://docs.spring.io/spring-framework/reference/web/websocket.html).

Code quality checking and coverage analysis is provided by [SonarCloud](https://sonarcloud.io/project/overview?id=gammaStrahlung_monopoly_server).

### Testing

Tests can be run locally using the following command:
```sh
./gradlew test
```
A detailed code coverage analysis report generated by [JaCoCo](https://www.jacoco.org/) can be viewed in the `build/jacocoHTML` folder after executing this command.